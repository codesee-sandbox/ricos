syntax = "proto3";

import "google/protobuf/timestamp.proto";
import "plugin_image_schema.proto";
import "plugin_divider_schema.proto";
import "plugin_color_schema.proto";
import "plugin_heading_schema.proto";
import "plugin_anchor_schema.proto";
import "plugin_button_schema.proto";
import "plugin_file_schema.proto";
import "plugin_gallery_schema.proto";
import "plugin_giphy_schema.proto";
import "plugin_html_schema.proto";
import "plugin_link_schema.proto";
import "plugin_link_preview_schema.proto";
import "plugin_map_schema.proto";
import "plugin_mention_schema.proto";
import "plugin_poll_schema.proto";
import "plugin_sound_cloud_schema.proto";
import "plugin_video_schema.proto";
import "plugin_vertical_embed_schema.proto";
import "plugin_emoji_schema.proto";

message RicosContent {
    Document doc = 1 [required = true]; /// Document root
    Selection selection = 2; /// Last saved selection
    string version = 3 [required = true]; /// Ricos version used to create this schema
}

message Document {
    repeated Node nodes = 1 [required = true]; /// List of nodes
    google.protobuf.Timestamp last_edited = 2 [required = true]; /// Timestamp when the document was last edited
}

message Selection {
    string anchor_node = 1 [required = true]; /// Selection start node key
    int32 anchor_offset = 2; /// Selection start offset (default: 0)
    string focus_node = 3; /// Selection end node key
    int32 focus_offset = 4; /// Selection end offset (default: 0)
}

message Node {
    string type = 1 [required = true]; /// Node type
    string key = 2 [required = true]; /// Node unique indentifier
    repeated Node nodes = 3 [required = true]; /// List of child nodes
    oneof data {
        RicosText ricos_text = 4;
        RicosImage ricos_image = 5;
        RicosDivider ricos_divider = 6;
        RicosHeading ricos_heading = 7;
        RicosAnchor ricos_anchor = 8;
        RicosButton ricos_button = 9;
        RicosFile ricos_file = 10;
        RicosGallery ricos_gallery = 11;
        RicosGiphy ricos_giphy = 12;
        RicosHTML ricos_html = 13;
        RicosLink ricos_link = 14;
        RicosLinkPreview ricos_link_preview = 15;
        RicosMap ricos_map = 16;
        RicosPoll ricos_poll = 17;
        RicosSoundCloud ricos_sound_cloud = 18;
        RicosVideo ricos_video = 19;
        RicosVerticalEmbed ricos_vertical_embed = 20;
        RicosMention ricos_mention = 21;
    }
}

message RicosText {
    string text = 1 [required = true]; /// Textual data
    repeated Decoration decorations = 2; /// List of decorations
}

/// Adds appearence changes to text
message Decoration {
    string type = 1 [required = true]; /// Decoration type
    oneof data {
        RicosColor ricos_color = 2;
        RicosAlignment ricos_alignment = 3;
        RicosEmoji ricos_emoji = 4;
    }
}

message RicosAlignment {
    string direction = 1;
}